var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define(["require","underscore","backbone","text!templates/map/_searchbox.html","text!templates/map/_layersbox.html"],function(e){var t,n,r,i;return i=e("underscore"),t=e("backbone"),r=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.events={"click .search":"onSearchBtnClick","change .location-type":"onTypeChange"},n.prototype.initialize=function(){return this.template=i.template(e("text!templates/map/_searchbox.html"))},n.prototype.render=function(){var e;return e=this.template(),this.$el.html(e),this},n.prototype.onTypeChange=function(){var e;return e=this.$(".location-type").val(),e==="address"?(this.$(".latLng-container").hide(),this.$(".address-container").show()):(this.$(".address-container").hide(),this.$(".latLng-container").show())},n.prototype.onSearchBtnClick=function(){var e,t;return t=this.$(".location-type").val(),e=t==="address"?this.$(".address").val():[parseFloat(this.$(".lat").val().replace(",",".")),parseFloat(this.$(".lng").val().replace(",","."))],this.search(t,e),!1},n.prototype.search=function(e,t){return e==null&&(e="address"),this.trigger("search",{type:e,position:t}),this},n}(t.View),n=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.events={"click .layer .item":"toggleLayer","click .layer .collapser":"toggleSublist","click .feature":"highlightFeature"},n.prototype.initialize=function(){return this.template=i.template(e("text!templates/map/_layersbox.html"))},n.prototype.render=function(e){var t;return this.layers=e,t=this.template({layers:this.layers}),this.$el.html(t),this.$(".sublist").hide(),this},n.prototype.updateCounters=function(e){var t=this;return e.forEach(function(e){return t.$("[data-layer="+e.getId()+"] .length").text(e.countFeatures())})},n.prototype.updateSublists=function(e){var t=this;return e.forEach(function(e){var n,r;if(e.countFeatures())return t.$("[data-layer="+e.getId()+"]").parent().find(".collapser").show(),n=t.$(".sublist[data-layer="+e.getId()+"]"),r=n.find("ul").empty(),e.getFeatures().forEach(function(e){return r.append('<li class="feature" data-type="'+e.getProperty("type")+'" data-id="'+e.getProperty("id")+'">'+e.getProperty("name")+"</li>")})})},n.prototype.toggleLayer=function(e){var t,n,r,i;return t=this.$(e.currentTarget),i=t.attr("data-layer"),r=t.attr("data-visible")==="true",n=r?"hide":"show",this.trigger(n,i),t.attr("data-visible",!r),t.toggleClass("on off")},n.prototype.toggleSublist=function(e){var t,n;return t=this.$(e.currentTarget),n=t.parent().next(".sublist"),console.log(n),t.find("i").toggleClass("icon-chevron-right icon-chevron-down"),n.toggle()},n.prototype.highlightFeature=function(e){var t,n,r;return t=this.$(e.currentTarget),r=t.attr("data-type"),n=parseInt(t.attr("data-id")),this.trigger("highlight_feature",r,n)},n}(t.View),{SearchBoxView:r,LayersBoxView:n}});