var $;$=jQuery,window.Signature=Backbone.Model.extend({imageName:function(){return"/static/img/updates-page/"+this.model_name+"-feed.png"},toJSON:function(e){var t;return t=Backbone.Model.prototype.toJSON.call(this,e),_.extend(t,{imageName:this.imageName})},deleteSignature:function(){var e;if(confirm(gettext("Are you sure that you want to delete your subscription for this content?")))return e=this,$.post(dutils.urls.resolve("signature_delete"),{id:this.get("signature_id")},function(t){return e.trigger("deleteSignature",e)},"json")}}),window.SignatureView=Backbone.View.extend({className:"signature",events:{"click .cancel-subscription-btn":"cancelSubscription"},initialize:function(){return _.bindAll(this,"render","cancelSubscription","remove"),this.template=_.template($("#signature-template").html()),this.model.bind("deleteSignature",this.remove)},render:function(){var e;return e=this.template(this.model.toJSON()),$(this.el).html(e),this},cancelSubscription:function(){return this.model.deleteSignature(),this},remove:function(){return $(this.el).slideUp(300,function(){return $(this).remove()}),this}}),window.SignaturesList=Backbone.Collection.extend({model:Signature}),window.SignaturesListView=Backbone.View.extend({events:{"click #signatures-manage-btn":"digestOptions","click #digest-options-save":"digestOptionsSave"},initialize:function(){return _.bindAll(this,"render","digestOptions"),this.template=_.template($("#signatures-list-collection").html()),this.collection.bind("reset",this.render)},render:function(){var e,t,n;return $(this.el).html(this.template({})),e=this.$(".signatures-list"),this.digestModal=this.$("#digest-options-modal"),this.digestForm=this.$("#form-digest"),t=this.collection,t.each(function(t){var n;return n=new SignatureView({model:t}),e.append(n.render().el)}),n=this,this.digestForm.ajaxform({clean:!1,onSuccess:function(){return n.digestModal.modal("hide")}}),this},digestOptions:function(){return this.digestModal.modal("show"),this},digestOptionsSave:function(){return this.digestForm.submit()}}),$(function(){var e,t;return $("#form-profile").ajaxform({clean:!1,onSuccess:function(e){var t,n,r;return t=$(".form-message-box"),t.length&&t.remove(),n=_.template($("#form-message-box").html()),r=n({msg:gettext("Your public data has been saved successfully.")}),$("#form-profile .form-actions").before(r),$("#form-profile .alert").fadeIn(),!1}}),$("#form-profile").komooFormHintBoxes({contact:{hint:gettext("Este contanto ficará visível para outros usuários do MootiroMaps!"),top:"30%"}}),$(".alert .close").live("click",function(){return $(this).parent().slideUp()}),$("#form-personal").ajaxform({clean:!1,onSuccess:function(e){var t,n,r;return t=$(".form-message-box"),t.length&&t.remove(),n=_.template($("#form-message-box").html()),r=n({msg:gettext("Your personal data has been saved successfully!")}),$("#form-personal .form-actions").before(r),$("#form-personal .alert").fadeIn(),!1}}),e=new SignaturesList,e.reset(window.KomooNS.signatures),t=new SignaturesListView({collection:e}),$(".signatures-list-wrapper").append(t.render().el)});